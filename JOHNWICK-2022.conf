#NXLOG Config - JOHNWICK Customer

#INPUT PORT
<Input JOHNWICK_2022>
    Module      im_tcp
    Host        0.0.0.0
    Port        2022
    Exec        parse_syslog();
</Input>

#Filters Host

#Filters Host1 "dkjfdskfj"
    <Processor filter_JOHNWICK_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /dkjfdskfj/
</Processor>

#Filters Host2 "dsfdsfsdf"
    <Processor filter_JOHNWICK_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /dsfdsfsdf/
</Processor>

#Filters Host3 "fsdfdsf"
    <Processor filter_JOHNWICK_HOST3>
    Module      pm_filter
    Condition   $raw_event =~ /fsdfdsf/
</Processor>

#Filters Host4 "fsdfsdfsd"
    <Processor filter_JOHNWICK_HOST4>
    Module      pm_filter
    Condition   $raw_event =~ /fsdfsdfsd/
</Processor>

#Filters Host5 "dfsdfsd"
    <Processor filter_JOHNWICK_HOST5>
    Module      pm_filter
    Condition   $raw_event =~ /dfsdfsd/
</Processor>

#Filters Host6 "fsdfsd"
    <Processor filter_JOHNWICK_HOST6>
    Module      pm_filter
    Condition   $raw_event =~ /fsdfsd/
</Processor>

#Filters Host7 "fsdfsd"
    <Processor filter_JOHNWICK_HOST7>
    Module      pm_filter
    Condition   $raw_event =~ /fsdfsd/
</Processor>

#Filters Host8 "fsdfsd"
    <Processor filter_JOHNWICK_HOST8>
    Module      pm_filter
    Condition   $raw_event =~ /fsdfsd/
</Processor>
#Output Log Template


<Output fileout_JOHNWICK_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "dkjfdskfj" + "/" + "dkjfdskfj" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "dsfdsfsdf" + "/" + "dsfdsfsdf" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST3>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "fsdfdsf" + "/" + "fsdfdsf" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST4>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "fsdfsdfsd" + "/" + "fsdfsdfsd" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST5>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "dfsdfsd" + "/" + "dfsdfsd" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST6>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "fsdfsd" + "/" + "fsdfsd" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST7>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "fsdfsd" + "/" + "fsdfsd" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHNWICK_HOST8>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHNWICK_2022" + "/" + "fsdfsd" + "/" + "fsdfsd" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>
#Route Archive


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST1 => fileout_JOHNWICK_HOST1
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST2 => fileout_JOHNWICK_HOST2
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST3 => fileout_JOHNWICK_HOST3
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST4 => fileout_JOHNWICK_HOST4
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST5 => fileout_JOHNWICK_HOST5
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST6 => fileout_JOHNWICK_HOST6
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST7 => fileout_JOHNWICK_HOST7
</Route>


<Route JOHNWICK>
    Path       JOHNWICK_2022 => filter_JOHNWICK_HOST8 => fileout_JOHNWICK_HOST8
</Route>
#Input Log JOHNWICK


<Input JOHNWICK_HOST1>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/dkjfdskfj/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST2>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/dsfdsfsdf/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST3>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/fsdfdsf/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST4>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/fsdfsdfsd/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST5>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/dfsdfsd/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST6>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/fsdfsd/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST7>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/fsdfsd/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHNWICK_HOST8>
    Module      im_file
    File        "/home/syslog/JOHNWICK_2022/fsdfsd/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Output ERC2_JOHNWICK_Windows>
    Module  om_udp
    Host    10.1.1.1
    Port    2022
</Output>

#Route Log Windows to ERC2 port 2022 
<Route forwardLog>
    Path      JOHNWICK_HOST1,JOHNWICK_HOST2,JOHNWICK_HOST3,JOHNWICK_HOST4,JOHNWICK_HOST5,JOHNWICK_HOST6,JOHNWICK_HOST7,JOHNWICK_HOST8  => ERC2_JOHNWICK_Windows
</Route>    

