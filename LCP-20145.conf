#Auto Config NXLOG - Demo01

#INPUT PORT
<Input LCP_20145>
    Module      im_tcp
    Host        0.0.0.0
    Port        20145
    Exec        parse_syslog();
</Input>

#Output To SIEM
#Filters Host
#Filters Host1 "google"
    <Processor filter_LCP_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /google/
</Processor>
#Filters Host2 "youtube"
    <Processor filter_LCP_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /youtube/
</Processor>
#Output Log Template
<Output fileout_LCP_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/LCP_20145" + "/" + "LCP_HOST1" + "/" + "LCP_HOST1" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>
<Output fileout_LCP_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/LCP_20145" + "/" + "LCP_HOST2" + "/" + "LCP_HOST2" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>
#Route Archive
<Route LCP>
    Path       LCP_20145 => filter_LCP_HOST1 => fileout_LCP_HOST1
</Route>

<Route LCP>
    Path       LCP_20145 => filter_LCP_HOST2 => fileout_LCP_HOST2
</Route>

#Input Log LCP
<Input LCPHost1>
    Module      im_file
    File        "/home/syslog/LCP/google/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>
<Input LCPHost2>
    Module      im_file
    File        "/home/syslog/LCP/youtube/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Output ERC2_LCP_Windows>
    Module  om_udp
    Host    10.11.100.131
    Port    514
</Output>

#Route Log Windows to ERC2 port 514 
<Route forwardLog>
    Path      LCP_HOST1,LCP_HOST2,  => ERC2_LCP_Windows
</Route>    

