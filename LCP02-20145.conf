#Auto Config NXLOG - Demo01

#INPUT PORT
<Input LCP02_20145>
    Module      im_tcp
    Host        0.0.0.0
    Port        20145
    Exec        parse_syslog();
</Input>



#Filters Host
#Filters Host1 "google"
    <Processor filter_LCP02_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /google/
</Processor>

#Filters Host
#Filters Host2 "youtube"
    <Processor filter_LCP02_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /youtube/
</Processor>


#Output Log Template
<Output fileout_LCP02_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/LCP02_20145" + "/" + "LCP02_HOST1" + "/" + "LCP02_HOST1" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

#Output Log Template
<Output fileout_LCP02_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/LCP02_20145" + "/" + "LCP02_HOST2" + "/" + "LCP02_HOST2" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


#Route Archive
<Route LCP02>
    Path       LCP02_20145 => filter_LCP02_HOST1 => fileout_LCP02_HOST1
</Route>

#Route Archive
<Route LCP02>
    Path       LCP02_20145 => filter_LCP02_HOST2 => fileout_LCP02_HOST2
</Route>


#Input Log LCP02
<Input LCP02Host1>
    Module      im_file
    File        "/home/syslog/LCP02/google/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

#Input Log LCP02
<Input LCP02Host2>
    Module      im_file
    File        "/home/syslog/LCP02/youtube/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Output ERC2_LCP02_Windows>
    Module  om_udp
    Host    10.11.100.131
    Port    514
</Output>

#Route Log Windows to ERC2 port 514 
<Route forwardLog>
    Path      LCP02_HOST1,LCP02_HOST2,  => ERC2_LCP02_Windows
</Route>    

