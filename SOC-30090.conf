#NXLOG Config - SOC Customer

#INPUT PORT
<Input SOC_30090>
    Module      im_tcp
    Host        0.0.0.0
    Port        30090
    Exec        parse_syslog();
</Input>

#Filters Host
#Filters Host1 "Google"
    <Processor filter_SOC_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /Google/
</Processor>

#Filters Host2 "Hotmail"
    <Processor filter_SOC_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /Hotmail/
</Processor>

#Filters Host3 "Youtube"
    <Processor filter_SOC_HOST3>
    Module      pm_filter
    Condition   $raw_event =~ /Youtube/
</Processor>


#Output Log Template
<Output fileout_SOC_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/SOC_30090" + "/" + "Google" + "/" + "Google" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

<Output fileout_SOC_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/SOC_30090" + "/" + "Hotmail" + "/" + "Hotmail" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

<Output fileout_SOC_HOST3>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/SOC_30090" + "/" + "Youtube" + "/" + "Youtube" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

#Output Log Host Monitor Template
<Output fileout_SOC_MonitorHost>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/SOC_30090" + "/" + "MonitorHost" + "/" + HOSTNAME
</Output>

#Route Archive
#Route Filter Archive
<Route SOC>
    Path       SOC_30090 => filter_SOC_HOST1 => fileout_SOC_HOST1
</Route>

<Route SOC>
    Path       SOC_30090 => filter_SOC_HOST2 => fileout_SOC_HOST2
</Route>

<Route SOC>
    Path       SOC_30090 => filter_SOC_HOST3 => fileout_SOC_HOST3
</Route>

# Route MonitorHost Archives
<Route SOC_MonitorHost>
    Path       SOC_30090 => fileout_SOC_MonitorHost
</Route>


#Input Log SOC
<Input SOC_HOST1>
    Module      im_file
    File        "/home/syslog/SOC_30090/Google/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Input SOC_HOST2>
    Module      im_file
    File        "/home/syslog/SOC_30090/Hotmail/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Input SOC_HOST3>
    Module      im_file
    File        "/home/syslog/SOC_30090/Youtube/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


#Output To ERC14 port 514
<Output ERC14_SOC_HostAll>
    Module  om_udp
    Host    10.11.100.132
    Port    514
</Output>


#Route Log HostAll to ERC14 port 514
<Route forwardLog>
    Path      SOC_HOST1,SOC_HOST2,SOC_HOST3  => ERC14_SOC_HostAll
</Route>    

