#Auto Config NXLOG - Demo01

#INPUT PORT
<Input XMEN_20145>
    Module      im_tcp
    Host        0.0.0.0
    Port        20145
    Exec        parse_syslog();
</Input>

#Filters Host

#Filters Host1 "google"
    <Processor filter_XMEN_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /google/
</Processor>

#Filters Host2 "youtube"
    <Processor filter_XMEN_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /youtube/
</Processor>

#Filters Host3 "facebook"
    <Processor filter_XMEN_HOST3>
    Module      pm_filter
    Condition   $raw_event =~ /facebook/
</Processor>
#Output Log Template


<Output fileout_XMEN_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_20145" + "/" + "google" + "/" + "google" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_20145" + "/" + "youtube" + "/" + "youtube" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST3>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_20145" + "/" + "facebook" + "/" + "facebook" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>
#Route Archive


<Route XMEN>
    Path       XMEN_20145 => filter_XMEN_HOST1 => fileout_XMEN_HOST1
</Route>


<Route XMEN>
    Path       XMEN_20145 => filter_XMEN_HOST2 => fileout_XMEN_HOST2
</Route>


<Route XMEN>
    Path       XMEN_20145 => filter_XMEN_HOST3 => fileout_XMEN_HOST3
</Route>
#Input Log XMEN


<Input XMENHost1>
    Module      im_file
    File        "/home/syslog/XMEN/google/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMENHost2>
    Module      im_file
    File        "/home/syslog/XMEN/youtube/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMENHost3>
    Module      im_file
    File        "/home/syslog/XMEN/facebook/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Output ERC14_XMEN_XMEN_Hosts>
    Module  om_udp
    Host    10.11.100.132
    Port    20146
</Output>

#Route Log XMEN_Hosts to ERC14 port 20146 
<Route forwardLog>
    Path      XMEN_HOST1,XMEN_HOST2,XMEN_HOST3  => ERC14_XMEN_XMEN_Hosts
</Route>    

