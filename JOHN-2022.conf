#NXLOG Config - JOHN Customer

#INPUT PORT
<Input JOHN_2022>
    Module      im_tcp
    Host        0.0.0.0
    Port        2022
    Exec        parse_syslog();
</Input>

#Filters Host

#Filters Host1 "fldskflsdk"
    <Processor filter_JOHN_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /fldskflsdk/
</Processor>

#Filters Host2 "fdsfsdf"
    <Processor filter_JOHN_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /fdsfsdf/
</Processor>

#Filters Host3 "fsdfsdf"
    <Processor filter_JOHN_HOST3>
    Module      pm_filter
    Condition   $raw_event =~ /fsdfsdf/
</Processor>
#Output Log Template


<Output fileout_JOHN_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHN_2022" + "/" + "fldskflsdk" + "/" + "fldskflsdk" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHN_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHN_2022" + "/" + "fdsfsdf" + "/" + "fdsfsdf" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_JOHN_HOST3>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/JOHN_2022" + "/" + "fsdfsdf" + "/" + "fsdfsdf" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>
#Route Archive


<Route JOHN>
    Path       JOHN_2022 => filter_JOHN_HOST1 => fileout_JOHN_HOST1
</Route>


<Route JOHN>
    Path       JOHN_2022 => filter_JOHN_HOST2 => fileout_JOHN_HOST2
</Route>


<Route JOHN>
    Path       JOHN_2022 => filter_JOHN_HOST3 => fileout_JOHN_HOST3
</Route>
#Input Log JOHN


<Input JOHN_HOST1>
    Module      im_file
    File        "/home/syslog/JOHN_2022/fldskflsdk/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHN_HOST2>
    Module      im_file
    File        "/home/syslog/JOHN_2022/fdsfsdf/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input JOHN_HOST3>
    Module      im_file
    File        "/home/syslog/JOHN_2022/fsdfsdf/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Output ERC2_JOHN_Windws>
    Module  om_udp
    Host    10.11.100.131
    Port    2022
</Output>

#Route Log Windws to ERC2 port 2022 
<Route forwardLog>
    Path      JOHN_HOST1,JOHN_HOST2,JOHN_HOST3  => ERC2_JOHN_Windws
</Route>    

