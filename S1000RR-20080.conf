#NXLOG Config - S1000RR Customer

#INPUT PORT
<Input S1000RR_20080>
    Module      im_tcp
    Host        0.0.0.0
    Port        20080
    Exec        parse_syslog();
</Input>

#Filters Host
#Filters Host1 "Google"
    <Processor filter_S1000RR_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /Google/
</Processor>

#Filters Host2 "Garena"
    <Processor filter_S1000RR_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /Garena/
</Processor>

#Filters Host3 "Hotmail"
    <Processor filter_S1000RR_HOST3>
    Module      pm_filter
    Condition   $raw_event =~ /Hotmail/
</Processor>


#Output Log Template
<Output fileout_S1000RR_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/S1000RR_20080" + "/" + "Google" + "/" + "Google" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

<Output fileout_S1000RR_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/S1000RR_20080" + "/" + "Garena" + "/" + "Garena" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

<Output fileout_S1000RR_HOST3>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/S1000RR_20080" + "/" + "Hotmail" + "/" + "Hotmail" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>

#Output Log Host Monitor Template
<Output fileout_S1000RR_MonitorHost>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/S1000RR_20080" + "/" + "MonitorHost" + "/" + $HOSTNAME
</Output>

#Route Archive
#Route Filter Archive
<Route S1000RR>
    Path       S1000RR_20080 => filter_S1000RR_HOST1 => fileout_S1000RR_HOST1
</Route>

<Route S1000RR>
    Path       S1000RR_20080 => filter_S1000RR_HOST2 => fileout_S1000RR_HOST2
</Route>

<Route S1000RR>
    Path       S1000RR_20080 => filter_S1000RR_HOST3 => fileout_S1000RR_HOST3
</Route>

# Route MonitorHost Archives
<Route S1000RR_MonitorHost>
    Path       S1000RR_20080 => fileout_S1000RR_MonitorHost
</Route>


#Input Log S1000RR
<Input S1000RR_HOST1>
    Module      im_file
    File        "/home/syslog/S1000RR_20080/Google/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Input S1000RR_HOST2>
    Module      im_file
    File        "/home/syslog/S1000RR_20080/Garena/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

<Input S1000RR_HOST3>
    Module      im_file
    File        "/home/syslog/S1000RR_20080/Hotmail/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


#Output To ERC14 port 200
<Output ERC14_S1000RR_HostAll>
    Module  om_udp
    Host    10.11.100.132
    Port    200
</Output>


#Route Log HostAll to ERC14 port 200
<Route forwardLog>
    Path      S1000RR_HOST1,S1000RR_HOST2,S1000RR_HOST3  => ERC14_S1000RR_HostAll
</Route>    

