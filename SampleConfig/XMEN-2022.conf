#Auto Config NXLOG - Demo01

#INPUT PORT
<Input XMEN_2022>
    Module      im_tcp
    Host        0.0.0.0
    Port        2022
    Exec        parse_syslog();
</Input>

#Filters Host

#Filters Host1 "DC01_AD"
    <Processor filter_XMEN_HOST1>
    Module      pm_filter
    Condition   $raw_event =~ /DC01_AD/
</Processor>

#Filters Host2 "ME"
    <Processor filter_XMEN_HOST2>
    Module      pm_filter
    Condition   $raw_event =~ /ME/
</Processor>

#Filters Host3 "FORMULA_APP"
    <Processor filter_XMEN_HOST3>
    Module      pm_filter
    Condition   $raw_event =~ /FORMULA_APP/
</Processor>

#Filters Host4 "upload2.ondemand.com"
    <Processor filter_XMEN_HOST4>
    Module      pm_filter
    Condition   $raw_event =~ /upload2.ondemand.com/
</Processor>

#Filters Host5 "02_APP"
    <Processor filter_XMEN_HOST5>
    Module      pm_filter
    Condition   $raw_event =~ /02_APP/
</Processor>

#Filters Host6 "WORKPLAC.ondemand.com"
    <Processor filter_XMEN_HOST6>
    Module      pm_filter
    Condition   $raw_event =~ /WORKPLAC.ondemand.com/
</Processor>

#Filters Host7 "HO2008.ondemand.com"
    <Processor filter_XMEN_HOST7>
    Module      pm_filter
    Condition   $raw_event =~ /HO2008.ondemand.com/
</Processor>

#Filters Host8 "hq1.ondemand.com"
    <Processor filter_XMEN_HOST8>
    Module      pm_filter
    Condition   $raw_event =~ /hq1.ondemand.com/
</Processor>

#Filters Host9 "Mcafee.ondemand.com"
    <Processor filter_XMEN_HOST9>
    Module      pm_filter
    Condition   $raw_event =~ /Mcafee.ondemand.com/
</Processor>

#Filters Host10 "LE.ondemand.com"
    <Processor filter_XMEN_HOST10>
    Module      pm_filter
    Condition   $raw_event =~ /LE.ondemand.com/
</Processor>

#Filters Host11 "HQ"
    <Processor filter_XMEN_HOST11>
    Module      pm_filter
    Condition   $raw_event =~ /HQ/
</Processor>

#Filters Host12 "unifiapp"
    <Processor filter_XMEN_HOST12>
    Module      pm_filter
    Condition   $raw_event =~ /unifiapp/
</Processor>

#Filters Host13 "unifiserver"
    <Processor filter_XMEN_HOST13>
    Module      pm_filter
    Condition   $raw_event =~ /unifiserver/
</Processor>

#Filters Host14 "unifidb"
    <Processor filter_XMEN_HOST14>
    Module      pm_filter
    Condition   $raw_event =~ /unifidb/
</Processor>

#Filters Host15 "zabbixhq"
    <Processor filter_XMEN_HOST15>
    Module      pm_filter
    Condition   $raw_event =~ /zabbixhq/
</Processor>

#Filters Host16 "AD"
    <Processor filter_XMEN_HOST16>
    Module      pm_filter
    Condition   $raw_event =~ /AD/
</Processor>

#Filters Host17 "dc"
    <Processor filter_XMEN_HOST17>
    Module      pm_filter
    Condition   $raw_event =~ /dc/
</Processor>

#Filters Host18 "localhost"
    <Processor filter_XMEN_HOST18>
    Module      pm_filter
    Condition   $raw_event =~ /localhost/
</Processor>

#Filters Host19 "SVR"
    <Processor filter_XMEN_HOST19>
    Module      pm_filter
    Condition   $raw_event =~ /SVR/
</Processor>

#Filters Host20 "VPN"
    <Processor filter_XMEN_HOST20>
    Module      pm_filter
    Condition   $raw_event =~ /VPN/
</Processor>

#Filters Host21 "exzy"
    <Processor filter_XMEN_HOST21>
    Module      pm_filter
    Condition   $raw_event =~ /exzy/
</Processor>

#Filters Host22 "SVR"
    <Processor filter_XMEN_HOST22>
    Module      pm_filter
    Condition   $raw_event =~ /SVR/
</Processor>
#Output Log Template


<Output fileout_XMEN_HOST1>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "DC01_AD" + "/" + "DC01_AD" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST2>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "ME" + "/" + "ME" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST3>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "FORMULA_APP" + "/" + "FORMULA_APP" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST4>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "upload2.ondemand.com" + "/" + "upload2.ondemand.com" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST5>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "02_APP" + "/" + "02_APP" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST6>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "WORKPLAC.ondemand.com" + "/" + "WORKPLAC.ondemand.com" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST7>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "HO2008.ondemand.com" + "/" + "HO2008.ondemand.com" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST8>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "hq1.ondemand.com" + "/" + "hq1.ondemand.com" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST9>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "Mcafee.ondemand.com" + "/" + "Mcafee.ondemand.com" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST10>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "LE.ondemand.com" + "/" + "LE.ondemand.com" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST11>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "HQ" + "/" + "HQ" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST12>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "unifiapp" + "/" + "unifiapp" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST13>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "unifiserver" + "/" + "unifiserver" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST14>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "unifidb" + "/" + "unifidb" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST15>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "zabbixhq" + "/" + "zabbixhq" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST16>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "AD" + "/" + "AD" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST17>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "dc" + "/" + "dc" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST18>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "localhost" + "/" + "localhost" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST19>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "SVR" + "/" + "SVR" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST20>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "VPN" + "/" + "VPN" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST21>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "exzy" + "/" + "exzy" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>


<Output fileout_XMEN_HOST22>
    CreateDir TRUE
    Module      om_file
    File        "/home/syslog/XMEN_2022" + "/" + "SVR" + "/" + "SVR" + "-" + strftime(now(), "%Y-%m-%d-%H") + ".log"
</Output>
#Route Archive


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST1 => fileout_XMEN_HOST1
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST2 => fileout_XMEN_HOST2
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST3 => fileout_XMEN_HOST3
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST4 => fileout_XMEN_HOST4
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST5 => fileout_XMEN_HOST5
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST6 => fileout_XMEN_HOST6
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST7 => fileout_XMEN_HOST7
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST8 => fileout_XMEN_HOST8
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST9 => fileout_XMEN_HOST9
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST10 => fileout_XMEN_HOST10
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST11 => fileout_XMEN_HOST11
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST12 => fileout_XMEN_HOST12
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST13 => fileout_XMEN_HOST13
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST14 => fileout_XMEN_HOST14
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST15 => fileout_XMEN_HOST15
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST16 => fileout_XMEN_HOST16
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST17 => fileout_XMEN_HOST17
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST18 => fileout_XMEN_HOST18
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST19 => fileout_XMEN_HOST19
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST20 => fileout_XMEN_HOST20
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST21 => fileout_XMEN_HOST21
</Route>


<Route XMEN>
    Path       XMEN_2022 => filter_XMEN_HOST22 => fileout_XMEN_HOST22
</Route>
#Input Log XMEN


<Input XMEN_HOST1>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/DC01_AD/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST2>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/ME/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST3>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/FORMULA_APP/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST4>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/upload2.ondemand.com/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST5>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/02_APP/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST6>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/WORKPLAC.ondemand.com/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST7>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/HO2008.ondemand.com/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST8>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/hq1.ondemand.com/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST9>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/Mcafee.ondemand.com/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST10>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/LE.ondemand.com/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST11>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/HQ/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST12>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/unifiapp/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST13>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/unifiserver/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST14>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/unifidb/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST15>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/zabbixhq/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST16>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/AD/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST17>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/dc/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST18>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/localhost/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST19>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/SVR/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST20>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/VPN/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST21>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/exzy/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>


<Input XMEN_HOST22>
    Module      im_file
    File        "/home/syslog//home/syslog/XMEN_2022/SVR/*.log"
    SavePos     TRUE
    ReadFromLast TRUE
    PollInterval 1
    Exec        parse_syslog();
</Input>

#Route Log  to  port  
<Route forwardLog>
    Path      XMEN_HOST1,XMEN_HOST2,XMEN_HOST3,XMEN_HOST4,XMEN_HOST5,XMEN_HOST6,XMEN_HOST7,XMEN_HOST8,XMEN_HOST9,XMEN_HOST10,XMEN_HOST11,XMEN_HOST12,XMEN_HOST13,XMEN_HOST14,XMEN_HOST15,XMEN_HOST16,XMEN_HOST17,XMEN_HOST18,XMEN_HOST19,XMEN_HOST20,XMEN_HOST21,XMEN_HOST22  => _XMEN_
</Route>    

